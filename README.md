# Классификация изображений

## Описание
Данный репозиторий содержит проект для классификации рукописных или загружаемых изображений с использованием метода выделения признаков (HOG) и модели машинного обучения. В качестве веб-фреймворков применяются Streamlit (интерактивный интерфейс для пользователя) и FastAPI (серверная часть для обработки изображений).
Пользователи могут нарисовать цифру прямо в браузере или загрузить изображение со своего устройства. Приложение обрабатывает изображение и предсказывает, какую цифру оно представляет, используя предварительно обученную модель машинного обучения.

## Используемые технологии

- **Python**: основной язык программирования проекта.
- **Streamlit**: фреймворк для создания веб-интерфейса.
- **FastAPI**: фреймворк для создания API сервера.
- **scikit-learn**: библиотека для машинного обучения.
- **Pillow**: библиотека для обработки изображений.
- **NumPy** и **scikit-image**: библиотеки для работы с массивами и обработки изображений.
- **HOG (Histogram of Oriented Gradients)**: метод извлечения признаков из изображений.
  
## Структура проекта
- **app.py**  
  Приложение на Streamlit, позволяющее:
  - Загрузить изображение или нарисовать его в интерактивном холсте.
  - Отправить изображение на сервер с помощью HTTP-запроса и вывести результат классификации.

- **main.py**  
  Серверная часть на базе FastAPI:
  - Принимает изображение в формате UploadFile.
  - Выделяет HOG-признаки.
  - Масштабирует признаки с помощью scaler.
  - Использует предобученную модель для вывода предсказания.

- **best_classification_model.pkl**  
  Сериализованная модель машинного обучения (pickle-файл).

- **scaler.pkl**  
  Сериализованный масштабатор признаков (pickle-файл).

- **requirements.txt**  
  Список зависимостей, необходимых для работы проекта.

## Установка и запуск

1. Клонируйте репозиторий или скачайте архив:
   ```
   git clone <URL_вашего_репозитория>
   cd <Папка_вашего_проекта>
   ```

2. Убедитесь, что у вас установлены Python 3.x и pip. Установите требуемые зависимости:
   ```
   pip install -r requirements.txt
   ```

3. В одном терминале запустите сервер FastAPI (при необходимости замените порт):
   ```
   uvicorn main:app --host 0.0.0.0 --port 8000
   ```

4. В другом терминале запустите приложение Streamlit:
   ```
   streamlit run app.py
   ```

5. Перейдите по адресу http://localhost:8501 (если не меняли порт по умолчанию) и протестируйте работу приложения:
   - Выберите режим «Загрузить изображение» и укажите файл, либо
   - Выберите режим «Нарисовать изображение» и создайте свой рисунок для классификации.

## Как это работает
1. При загрузке или рисовании изображение отправляется POST-запросом на сервер по маршруту `/predict/`.
2. Сервер (FastAPI) преобразует полученное изображение в массив, вычисляет HOG-дескриптор, масштабирует признаки и пропускает их через модель.
3. Итоговое предсказание отображается в веб-интерфейсе Streamlit с увеличенным шрифтом.

## Использование приложения

- **Нарисовать изображение:**
  - Выберите опцию "Нарисовать изображение".
  - Настройте толщину линии, цвет кисти и фона.
  - Нарисуйте цифру в предоставленном холсте.
- **Загрузить изображение:**
  - Выберите опцию "Загрузить изображение".
  - Загрузите изображение в формате JPG, JPEG или PNG.

После ввода изображения приложение автоматически отправит его на сервер для классификации. Результат отобразится рядом с изображением.

## Подробности реализации

- **Извлечение признаков:**
  - Используется метод HOG для извлечения признаков из изображений.
  - Изображение преобразуется в оттенки серого и изменяется его размер до 28x28 пикселей.
- **Модель машинного обучения:**
  - Используется предварительно обученная модель, сохраненная в `best_classification_model.pkl`.
  - Модель была обучена на наборе данных рукописных цифр.
- **Масштабирование признаков:**
  - Для улучшения качества предсказаний используется `StandardScaler`, сохраненный в `scaler.pkl`.

## Лицензия

Данный проект распространяется под лицензией MIT. Более подробную информацию можно найти в файле [LICENSE](https://mit-license.org/license.txt).
